---
title: 天地图卫星影像下载
date: 2025-11-11T14:12:36.000Z
categories: 
  - 资源
  - 教程
tags:
  - QGIS
  - GIS
  - 资源
  - 教程
# index_img: images/1749179465178.png
---

## **一、账号注册及Key获取**

1.进入天地图官网：[天地图API](http://lbs.tianditu.gov.cn/ "天地图API")，点击控制台进行账号注册。

2.登录成功后点击控制台，选择应用管理，创建新应用。

配置好你就可以获得对于的Key了，如下图所示

![](https://i-blog.csdnimg.cn/direct/bd0e74f53e2f48f09c3aec2a9482cd78.png)

## 二、地图数据下载GeoJSON

1.打开天地图服务中心下载[地图数据](https://so.csdn.net/so/search?q=%E5%9C%B0%E5%9B%BE%E6%95%B0%E6%8D%AE&spm=1001.2101.3001.7020)：[天地图 服务中心](https://cloudcenter.tianditu.gov.cn/administrativeDivision "天地图 服务中心")

2.下载你需要的数据，假设我需要下载两个数据，分别是全国数据和嘉兴市的地图数据。

全国数据的下载，按如下配置好后点击下载数据，等待下载完成即可：![](https://i-blog.csdnimg.cn/direct/742b972d8e5e4ce7a4db230b5f543f99.png)

嘉兴市数据的下载，在选择地区选择好省市开始下载即可：

![](https://i-blog.csdnimg.cn/direct/b236ed098b524cc0a8a14e4db06167ec.png)

浏览器下载好数据应该如下显示：

![](https://i-blog.csdnimg.cn/direct/faba72364e9e4ce1b5a5edca918a0162.png)

## 三、QGIS软件中添加并显示对应地图数据

### 1.**在 QGIS 中添加天地图服务** ：

  你需要分别添加卫星影像底图和地名注记图层。

（1）**在 QGIS 的“浏览器”面板中，找到 `XYZ Tiles`，右键点击并选择 `新建连接...`**

![](https://i-blog.csdnimg.cn/direct/15a2c890ad2940c2ace5ee78747b760c.png)

（2）**添加卫星影像底图****：在点开新建连接后把Name和URL配置好并点击确定。**

**卫星影像底图的链接：**[天地图API](http://lbs.tianditu.gov.cn/server/MapService.html "天地图API")

![](https://i-blog.csdnimg.cn/direct/07c0167e7a3a4c858dfb6b28a403e358.png)

#### **注意：**

这里的配置都是两两配对的，比如我用的是影像底图：

<table border="0" cellpadding="0" cellspacing="0" style="width:100%"><tbody><tr><td>http://t0.tianditu.gov.cn/img_w/wmts?tk=您的密钥</td><td>球面墨卡托投影</td></tr></tbody></table>

那么对应使用的影像注记就是：

<table border="0" cellpadding="0" cellspacing="0" style="width:100%"><tbody><tr><td>http://t0.tianditu.gov.cn/cia_w/wmts?tk=您的密钥</td><td>球面墨卡托投影</td></tr></tbody></table>

当前给的路径并不是正确的，需要完整的路径应该是：

> https://t0.tianditu.gov.cn/img\_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=你的密钥

> https://t0.tianditu.gov.cn/cia\_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=你的密钥

你只要在对应的“你的密钥”的位置填入你的第一步获得的密钥即可。

接下来，我们回归主体，在下图新建连接里面分别填入(填入的名称Name可以随意)：

> Name:TDT Satellite
> 
> URL：https://t0.tianditu.gov.cn/img\_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=你的密钥

![](https://i-blog.csdnimg.cn/direct/278c19124424412fa4d22ffbe4afa228.png)

然后就可以点击确定后，双击那个你已经新建的连接，效果如下则说明你成功添加了：

![](https://i-blog.csdnimg.cn/direct/b1313858b5904aafa96cc9356205d5d9.png)

（3）**添加影像注记图层（和上述步骤2类似）** **：在点开新建连接后把Name和URL配置好并点击确定。效果如下：**

#### **注意：图层Layers谁在上面优先显示谁，如下图**

![](https://i-blog.csdnimg.cn/direct/03db2f5ae70d4e4eb5629709fa570dd2.png)

### 2.**在 QGIS 中添加地图数据**GeoJSON并下载对应离线的地图数据 ：

#### **（1）将之前下载好的地图数据拖入QGIS软件中，效果如下：**

![](https://i-blog.csdnimg.cn/direct/54f428ea389a49789823c19bcb119889.png)

![](https://i-blog.csdnimg.cn/direct/5521586b8e274144a97b26100d69acfd.png)

#### **（2）使用插件生成地图瓦片包：**

#####         **1）安装插件：**

**点击菜单栏 `插件` -> `管理并安装插件...`**![](https://i-blog.csdnimg.cn/direct/a9730099ba9e4dd09b7ea39ab9b73557.png)

**在搜索框中输入 `QTiles`，找到后点击“安装插件”**![](https://i-blog.csdnimg.cn/direct/f05d5e66593149c19d814605c5b4cbcc.png)

#####         **2）打开插件： 安装成功后，在工具栏上找到它的图标。**

![](https://i-blog.csdnimg.cn/direct/d5c2719675fc49229f47decd943292d1.png)

#####          **3）配置参数，当前我打算下载中国地图瓦片包，具体配配置（全国地图级别ZOOM一般是0-10，市级别的用10-15）如下图：**

![](https://i-blog.csdnimg.cn/direct/0f73de2c08dc4db19b1c06c4dd87fcf6.png)

**output的参数可以通过点击右侧的更多三个点的按钮，按如下配置：**

![](https://i-blog.csdnimg.cn/direct/b58fac7b33b641c68a90ccf2731470f3.png)

**配置好后单击run等待其下载完毕。**

**上****面之前说过，地图数据需要成对下载，刚刚下载了影像底图，现在下对应的影像注记，记住layers的图层需要切换为注记的那个连接，然后依次配置好开始下载：**

![](https://i-blog.csdnimg.cn/direct/5a8539aadf46400f94e99bc87ff1d4dd.png)

**接下来是嘉兴市的影像底图和对应的对应的影像注记，配置如下：**

![](https://i-blog.csdnimg.cn/direct/679c1f9021f74729a5d2506c6c84af8e.png)

![](https://i-blog.csdnimg.cn/direct/e367d845d554454595c6c4bf9c6f5583.png)

**（3）配置地图config.json：**

**假设你已经下好了大量的地图数据：**

![](https://i-blog.csdnimg.cn/direct/5f6e92225a734630b6516db071a2bafc.png)

我们需要一个json文件来做映射配置，方便地图服务的部署：

例如我的config.json内容如下：

```csharp
{
   "options": {
      "paths": {
         "root": "/data",
         "mbtiles": "/data"
      }
   },
   "data": {
      "chinac_img_w_0_10": {
         "mbtiles": "chinac_img_w_0_10.mbtiles"
      },
      "china_cia_w_0_10": {
         "mbtiles": "china_cia_w_0_10.mbtiles"
      },
      "jiaxin_img_w_10_15": {
         "mbtiles": "jiaxin_img_w_10_15.mbtiles"
      },
      "jiaxin_cia_w_10_15": {
         "mbtiles": "jiaxin_cia_w_10_15.mbtiles"
      }
   }
}
```

以上完成后还需要用下文的docker来运行地图服务。

### 3.**在 QGIS 中添加地图数据**GeoJSON并下载对应离线的地图数据 ：

#### **（1）重新拉取 Docker 镜像**

首先，你需要从打开Docker Desktop后在命令提示符或powershell重新拉取 `maptiler/tileserver-gl` 镜像（**注意：你需要开启vpn连接外网才可以，否则会连接超时**）。打开您的终端（Terminal）并执行以下命令：

```bash
docker pull maptiler/tileserver-gl一键获取完整项目代码
```

#### （2）查找下载好的镜像名称

```undefined
docker images一键获取完整项目代码
```

你会看到一个列表，类似这样：

#### （3）**运行容器**

现在，你的离线镜像已经成功加载并准备就绪，通过以下命令启动你的地图服务：

把在我本地的地图项目启动起来:将容器的8080端口映射到主机的8083端口：

```cobol
docker run --rm -it -p 8083:8080 -v "C:\Users\dddsg\Desktop\mymapTiles":/data maptiler/tileserver-gl:latest一键获取完整项目代码
```

C:\\Users\\dddsg\\Desktop\\mymapTiles是你下载好的瓦片包：

![](https://i-blog.csdnimg.cn/direct/6d7f9ccf1f354dbb9f9c24bce2ab039e.png)

#### **注意：在测试过程中我遇到bug，我执行结果如下：**

```cobol
C:\Users\dddsg>docker run --rm -it -p 8083:8080 -v "C:/Users/dddsg/Desktop/公安项目/地图服务相关/mymapTiles":/data maptiler/tileserver-gl:latestWARNING: The requested image's platform (linux/arm64) does not match the detected host platform (linux/amd64/v3) and no specific platform was requestedStarting tileserver-gl v5.3.1Using specified config file from config.jsonStarting serverListening at http://[::]:8080/SQLITE_READONLY: attempt to write a readonly database一键获取完整项目代码
```

报错说我的文件夹是只读无法写入，应该是在桌面创建文件夹导致的，你需要把里面的文件移到一个新的你自己创建的文件夹，例如我之后执行：

> docker run --rm -it -p 8083:8080 -v "C:/Users/dddsg/Desktop/公安项目/地图服务相关/mymap":/data maptiler/tileserver-gl:latest

其中C:/Users/dddsg/Desktop/公安项目/地图服务相关/mymap 就是我自己新建的项目，执行后

![](https://i-blog.csdnimg.cn/direct/c2824c2b83e3497a9807bf217541c668.png)

在浏览器中的地址栏写入：

```cobol
http://localhost:8083/一键获取完整项目代码
```

这是我们映射的端口，效果图如下：

![](https://i-blog.csdnimg.cn/direct/0e0e68e69e4b4f969e03c603e5214bd4.png)

**这说明我们本地的项目成功跑起来了，恭喜你完成到这一步，接下来在vscode部署实现地图的展示。**
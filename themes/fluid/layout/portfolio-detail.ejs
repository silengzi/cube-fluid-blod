<%
page.layout = "portfolio-detail"
page.title = page.title || '作品详情'
page.subtitle = page.subtitle || page.title
page.banner_img = page.banner_img || theme.page.banner_img
page.banner_img_height = page.banner_img_height || theme.page.banner_img_height
page.banner_mask_alpha = page.banner_mask_alpha || theme.page.banner_mask_alpha
%>

<!-- 作品详情页布局 -->
<div class="portfolio-detail-container">
  <!-- 项目头部信息 -->
  <div class="project-header">
    <div class="project-hero">
      <% if (page.cover) { %>
        <div class="hero-image">
          <img src="<%= url_for(page.cover) %>" alt="<%= page.title %>" class="cover-image">
          <div class="hero-overlay"></div>
        </div>
      <% } %>

      <div class="hero-content">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-lg-8">
              <div class="project-info">
                <div class="project-badge">
                  <span class="badge"><%= page.type || '项目' %></span>
                </div>
                <h1 class="project-title"><%- page.title %></h1>
                <% if (page.summary) { %>
                  <p class="project-summary"><%= page.summary %></p>
                <% } %>
              </div>
            </div>

            <div class="col-lg-4">
              <div class="project-actions">
                <% if (page.links && page.links.length) { %>
                  <div class="action-buttons">
                    <% for (var i = 0; i < page.links.length; i++) { %>
                      <% var link = page.links[i] %>
                      <a href="<%= url_for(link.url) %>" target="_blank" rel="noopener" class="btn btn-primary">
                        <i class="iconfont icon-link"></i>
                        <%= link.text %>
                      </a>
                    <% } %>
                  </div>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 项目内容区域 -->
  <div class="project-content">
    <div class="container">
      <div class="row">
        <!-- 主要内容 -->
        <div class="col-lg-8">
          <div class="content-main">
            <!-- 项目描述 -->
            <div class="content-section">
              <h2 class="section-title">
                <i class="iconfont icon-file-text"></i>
                项目描述
              </h2>
              <div class="section-content">
                <%- page.content %>
              </div>
            </div>

            <!-- 项目截图 -->
            <% if (page.gallery && page.gallery.length) { %>
              <div class="content-section">
                <h2 class="section-title">
                  <i class="iconfont icon-image"></i>
                  项目截图
                </h2>
                <div class="gallery-grid">
                  <% for (var i = 0; i < page.gallery.length; i++) { %>
                    <% var img = page.gallery[i] %>
                    <div class="gallery-item">
                      <div class="gallery-image">
                        <img src="<%= url_for(img) %>" alt="截图 <%= i + 1 %>" class="screenshot">
                        <div class="gallery-overlay">
                          <i class="iconfont icon-zoom-in"></i>
                        </div>
                      </div>
                    </div>
                  <% } %>
                </div>
              </div>
            <% } %>
          </div>
        </div>

        <!-- 侧边栏 -->
        <div class="col-lg-4">
          <div class="content-sidebar">
            <!-- 技术栈 -->
            <% if (page.techs && page.techs.length) { %>
              <div class="sidebar-section">
                <h3 class="sidebar-title">
                  <i class="iconfont icon-code"></i>
                  技术栈
                </h3>
                <div class="tech-stack">
                  <% for (var i = 0; i < page.techs.length; i++) { %>
                    <% var tech = page.techs[i] %>
                    <span class="tech-tag"><%= tech %></span>
                  <% } %>
                </div>
              </div>
            <% } %>

            <!-- 项目信息 -->
            <div class="sidebar-section">
              <h3 class="sidebar-title">
                <i class="iconfont icon-info-circle"></i>
                项目信息
              </h3>
              <div class="project-meta">
                <div class="meta-item">
                  <span class="meta-label">类型</span>
                  <span class="meta-value"><%= page.type || '未分类' %></span>
                </div>
                <div class="meta-item">
                  <span class="meta-label">创建时间</span>
                  <span class="meta-value"><%= page.date ? new Date(page.date).toLocaleDateString('zh-CN') : '未知' %></span>
                </div>
                <% if (page.updated && page.updated !== page.date) { %>
                  <div class="meta-item">
                    <span class="meta-label">更新时间</span>
                    <span class="meta-value"><%= new Date(page.updated).toLocaleDateString('zh-CN') %></span>
                  </div>
                <% } %>
              </div>
            </div>

            <!-- 相关链接 -->
            <% if (page.links && page.links.length) { %>
              <div class="sidebar-section">
                <h3 class="sidebar-title">
                  <i class="iconfont icon-link"></i>
                  相关链接
                </h3>
                <div class="project-links">
                  <% for (var i = 0; i < page.links.length; i++) { %>
                    <% var link = page.links[i] %>
                    <a href="<%= url_for(link.url) %>" target="_blank" rel="noopener" class="link-item">
                      <i class="iconfont icon-external-link"></i>
                      <span><%= link.text %></span>
                    </a>
                  <% } %>
                </div>
              </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- inject_point('pageComments') %>

<style>
/* 作品详情页样式 */
.portfolio-detail-container {
  background: #f8f9fa;
  min-height: 100vh;
}

/* 项目头部区域 */
.project-header {
  position: relative;
  margin-bottom: 40px;
}

.project-hero {
  position: relative;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  overflow: hidden;
}

.hero-image {
  position: relative;
  height: 400px;
  overflow: hidden;
}

.cover-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: brightness(0.7);
}

.hero-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
}

.hero-content {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  padding: 60px 0;
}

.project-info {
  padding: 20px 0;
}

.project-badge {
  margin-bottom: 20px;
}

.badge {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 500;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.project-title {
  font-size: 3rem;
  font-weight: 700;
  margin-bottom: 20px;
  line-height: 1.2;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.project-summary {
  font-size: 1.2rem;
  line-height: 1.6;
  opacity: 0.9;
  max-width: 600px;
}

.project-actions {
  text-align: right;
}

.action-buttons {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.btn {
  padding: 12px 24px;
  border-radius: 8px;
  font-weight: 500;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all 0.3s ease;
  border: none;
  cursor: pointer;
}

.btn-primary {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.btn-primary:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

/* 项目内容区域 */
.project-content {
  padding: 40px 0;
}

.content-main {
  background: white;
  border-radius: 16px;
  padding: 40px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  margin-bottom: 30px;
}

.content-section {
  margin-bottom: 40px;
}

.content-section:last-child {
  margin-bottom: 0;
}

.section-title {
  font-size: 1.8rem;
  font-weight: 600;
  margin-bottom: 24px;
  color: #2d3748;
  display: flex;
  align-items: center;
  gap: 12px;
}

.section-title i {
  color: #667eea;
  font-size: 1.5rem;
}

.section-content {
  line-height: 1.8;
  color: #4a5568;
}

.section-content h1,
.section-content h2,
.section-content h3,
.section-content h4,
.section-content h5,
.section-content h6 {
  color: #2d3748;
  margin-top: 24px;
  margin-bottom: 16px;
}

.section-content p {
  margin-bottom: 16px;
}

.section-content ul,
.section-content ol {
  margin-bottom: 16px;
  padding-left: 24px;
}

.section-content li {
  margin-bottom: 8px;
}

/* 画廊样式 */
.gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.gallery-item {
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.gallery-item:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.gallery-image {
  position: relative;
  overflow: hidden;
}

.screenshot {
  width: 100%;
  height: 200px;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.gallery-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.gallery-overlay i {
  color: white;
  font-size: 2rem;
}

.gallery-item:hover .screenshot {
  transform: scale(1.05);
}

.gallery-item:hover .gallery-overlay {
  opacity: 1;
}

/* 侧边栏样式 */
.content-sidebar {
  position: sticky;
  top: 20px;
}

.sidebar-section {
  background: white;
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

.sidebar-title {
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: 16px;
  color: #2d3748;
  display: flex;
  align-items: center;
  gap: 8px;
}

.sidebar-title i {
  color: #667eea;
}

/* 技术栈标签 */
.tech-stack {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.tech-tag {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
}

/* 项目元信息 */
.project-meta {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.meta-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid #e2e8f0;
}

.meta-item:last-child {
  border-bottom: none;
}

.meta-label {
  color: #718096;
  font-size: 14px;
}

.meta-value {
  color: #2d3748;
  font-weight: 500;
  font-size: 14px;
}

/* 项目链接 */
.project-links {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.link-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background: #f7fafc;
  border-radius: 8px;
  color: #4a5568;
  text-decoration: none;
  transition: all 0.3s ease;
}

.link-item:hover {
  background: #edf2f7;
  color: #667eea;
  transform: translateX(4px);
}

.link-item i {
  color: #667eea;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .hero-content {
    padding: 40px 0;
  }

  .project-title {
    font-size: 2rem;
  }

  .project-summary {
    font-size: 1rem;
  }

  .content-main {
    padding: 24px;
  }

  .gallery-grid {
    grid-template-columns: 1fr;
  }

  .project-actions {
    text-align: left;
    margin-top: 20px;
  }

  .action-buttons {
    flex-direction: row;
    flex-wrap: wrap;
  }
}

/* 暗色模式适配 */
@media (prefers-color-scheme: dark) {
  .portfolio-detail-container {
    background: #1a202c;
  }

  .content-main,
  .sidebar-section {
    background: #2d3748;
    color: #e2e8f0;
  }

  .section-title,
  .sidebar-title {
    color: #e2e8f0;
  }

  .section-content {
    color: #a0aec0;
  }

  .meta-label {
    color: #a0aec0;
  }

  .meta-value {
    color: #e2e8f0;
  }

  .link-item {
    background: #4a5568;
    color: #a0aec0;
  }

  .link-item:hover {
    background: #2d3748;
    color: #63b3ed;
  }

  .meta-item {
    border-bottom-color: #4a5568;
  }
}
</style>



